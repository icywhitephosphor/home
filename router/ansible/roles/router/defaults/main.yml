---
# defaults file for router role

# System Configuration
router_ipv6_enabled: false
router_network_lan_ipaddr: "192.168.1.1"
router_network_lan_netmask: "255.255.255.0"
router_network_wan_proto: "dhcp"
router_network_wan_mac: "" # Must be set in group_vars! Get from router: cat /sys/class/net/wan/address

# Proxy Configuration
router_proxy_enabled: false
router_proxy_port: 2080

# 2G Network Configuration
# NOTE: Requires separate network zone for 2G WiFi (not implemented yet)
router_2g_without_vpn: false

# Performance - Packet Steering (RPS/XPS)
router_packet_steering: true

# Domain Lists - единый список, IPv6 контролируется через router_ipv6_enabled
# Файлы автоматически ищутся по пути: files/ipv4/<name>.lst и files/ipv6/<name>.lst
# Для включения: router_domains.<name>: true
router_domains_lists:
  - copilot
  - openai
  - google
  - datadog
  - instagram
  - netflix
  - telegram
  - claude
  - x
  - linkedin
  - windsurf
  - antigravity

# Services to exclude from VPN routing (patterns matched in downloaded list)
router_services_exclude: []

# Domain toggles - все false по умолчанию, переопределяются в group_vars
router_domains:
  copilot: false
  openai: false
  google: false
  datadog: false
  instagram: false
  netflix: false
  telegram: false
  claude: false
  x: false
  linkedin: false
  windsurf: false
  antigravity: false

# Sing-box Configuration
# Log level: trace, debug, info, warn, error, fatal, panic
router_singbox_log_level: error

# DNS servers for sing-box (routed through VPN)
router_singbox_dns_servers:
  - address: "tls://8.8.8.8"
    tag: "google-dns"
  - address: "tls://1.1.1.1"
    tag: "cloudflare-dns"

# TUN Inbound Configuration
router_singbox_inbound:
  interface_name: tun0 # Virtual device name
  address: ["172.16.250.1/30"] # IPv4/IPv6 prefixes for tun (replaces inet4_address)
  domain_strategy: ipv4_only # Domain resolution strategy: prefer_ipv4, prefer_ipv6, ipv4_only, ipv6_only
  mtu: 9000 # Maximum transmission unit
  auto_route: false # Set default route to TUN (requires route.auto_detect_interface)
  strict_route: false # Enforce strict routing rules
  sniff: true # Enable protocol sniffing
  stack: system # TCP/IP stack: system, gvisor, mixed
  endpoint_independent_nat: false # Enable endpoint-independent NAT (gvisor only)
  udp_timeout: "5m" # UDP NAT expiration time

# Route Configuration
router_singbox_route:
  auto_detect_interface: true # Auto-detect default interface

# VPN Servers list for urltest (REQUIRED in group_vars)
router_singbox_servers: []

# VLESS Outbound - общие настройки для всех серверов
# В group_vars переопределяются только реальные значения
router_singbox_outbound_common:
  tag: vpn-out # Outbound tag
  type: vless # Protocol type
  server_port: 443 # VPN server port
  flow: xtls-rprx-vision # VLESS flow: xtls-rprx-vision or empty

  # TLS Configuration
  tls:
    enabled: true # Enable TLS
    insecure: false # Accept any server certificate (DANGEROUS)
    server_name: "" # SNI server name for TLS (REQUIRED in group_vars)
    disable_sni: false # Do not send SNI in ClientHello

  # uTLS Configuration (ClientHello fingerprinting resistance)
  utls:
    enabled: true # Enable uTLS
    # Fingerprint: chrome, firefox, edge, safari, ios, android, random, 360, qq
    # randomized: Randomly choose a fingerprint for each connection
    # chrome/firefox/edge/safari: Mimic specific desktop browsers
    # ios/android: Mimic mobile devices
    fingerprint: random

  # Reality Configuration (TLS camouflage)
  reality:
    enabled: false # Enable Reality protocol
    public_key: "" # Reality public key (generate with: sing-box generate reality-keypair)
    short_id: "" # Hexadecimal string (0-8 digits)

# WiFi Configuration
router_wifi_devices: []
router_wifi_ifaces: []

# Performance - Sysctl Tuning
router_sysctl_enabled: true
router_sysctl_rmem_max: 16777216 # TCP receive buffer max (16MB)
router_sysctl_wmem_max: 16777216 # TCP send buffer max (16MB)
router_sysctl_rmem_default: 1048576 # TCP receive buffer default (1MB)
router_sysctl_wmem_default: 1048576 # TCP send buffer default (1MB)
router_sysctl_tcp_rmem: "4096 1048576 16777216" # TCP receive buffer (min default max)
router_sysctl_tcp_wmem: "4096 1048576 16777216" # TCP send buffer (min default max)
router_sysctl_netdev_max_backlog: 5000 # Network device backlog queue
router_sysctl_mtu_probing: 1 # Enable MTU probing (0=off, 1=on)

# Performance - irqbalance
router_irqbalance_enabled: true
