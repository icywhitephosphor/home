---
# defaults file for local role (macOS sing-box)

# ============================================================================
# Paths
# ============================================================================

local_config_dir: "{{ ansible_facts['env']['HOME'] }}/.config/sing-box"
local_pac_path: "{{ local_config_dir }}/proxy.pac"
local_run_script: "{{ local_config_dir }}/run-sing-box.sh"

# ============================================================================
# Network Configuration
# ============================================================================

local_proxy_port: 2080
local_ipv6_enabled: false

# ============================================================================
# Domain Lists (synchronized with router role)
# ============================================================================

local_domains_lists:
  - antigravity
  - claude
  - copilot
  - datadog
  - google
  - instagram
  - linkedin
  - netflix
  - openai
  - telegram
  - windsurf
  - x

# Services to exclude from VPN routing
local_services_exclude: []

# Включение/выключение доменов (по умолчанию все выключены)
local_domains:
  antigravity: false
  claude: false
  copilot: false
  datadog: false
  google: false
  instagram: false
  linkedin: false
  netflix: false
  openai: false
  telegram: false
  windsurf: false
  x: false

# Директория с доменными списками из роли router
local_domains_lists_dir: "{{ playbook_dir }}/../roles/router/files"

# ============================================================================
# PAC File Configuration
# ============================================================================

local_pac_enabled: true
local_pac_validate_certs: false

# Внешние источники доменов (ipset/nftset формат)
local_pac_extra_sources:
  - "https://raw.githubusercontent.com/itdoginfo/allow-domains/main/Russia/inside-dnsmasq-ipset.lst"

# ============================================================================
# sing-box Configuration
# ============================================================================

local_singbox_log_level: info

local_singbox_dns_servers:
  - tag: bootstrap
    type: udp
    server: "8.8.8.8"
  - tag: google-doh
    type: https
    server: dns.google
    server_port: 443
    domain_resolver: bootstrap

# ============================================================================
# VLESS Outbound Configuration
# ============================================================================

# Список VPN серверов (ОБЯЗАТЕЛЬНО в group_vars)
local_singbox_servers: []

# Общие настройки для всех серверов
local_singbox_outbound_common:
  tag: vpn-out
  type: vless
  server_port: 443
  flow: xtls-rprx-vision
  tls:
    enabled: true
    insecure: false
    server_name: ""
    disable_sni: false
  utls:
    enabled: true
    fingerprint: chrome
  reality:
    enabled: false
